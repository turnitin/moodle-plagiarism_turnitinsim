{"version":3,"sources":["../src/connection_test.js"],"names":["define","$","str","connectionTest","ct","length","click","ajax","type","url","M","cfg","wwwroot","dataType","data","action","sesskey","apiurl","val","apikey","success","connection_status","removeClass","addClass","changeString","get_string","delay","fadeOut","fadeIn","langString","get","tagName","text","attr"],"mappings":"AA4BAA,OAAM,0CAAC,CAAC,QAAD,CAAW,UAAX,CAAD,CAAyB,SAASC,CAAT,CAAYC,CAAZ,CAAiB,CAC5C,MAAO,CACHC,cAAc,CAAE,yBAAW,CAEvB,GAAIC,CAAAA,CAAE,CAAGH,CAAC,CAAC,qBAAD,CAAV,CAEA,GAAgB,CAAZ,CAAAG,CAAE,CAACC,MAAP,CAAmB,CACfD,CAAE,CAACE,KAAH,CAAS,UAAW,CAChBL,CAAC,CAACM,IAAF,CAAO,CACHC,IAAI,CAAE,MADH,CAEHC,GAAG,CAAEC,CAAC,CAACC,GAAF,CAAMC,OAAN,CAAgB,kDAFlB,CAGHC,QAAQ,CAAE,MAHP,CAIHC,IAAI,CAAE,CACFC,MAAM,CAAE,iBADN,CAEFC,OAAO,CAAEN,CAAC,CAACC,GAAF,CAAMK,OAFb,CAGFC,MAAM,CAAEhB,CAAC,CAAC,oBAAD,CAAD,CAAwBiB,GAAxB,EAHN,CAIFC,MAAM,CAAElB,CAAC,CAAC,oBAAD,CAAD,CAAwBiB,GAAxB,EAJN,CAJH,CAUHE,OAAO,CAAE,iBAASN,CAAT,CAAe,CACpB,GAA+B,GAA3B,GAAAA,CAAI,CAACO,iBAAT,CAAoC,CAChCjB,CAAE,CAACkB,WAAH,CAAe,wBAAf,EACAlB,CAAE,CAACmB,QAAH,CAAY,yBAAZ,EAEAC,CAAY,CAACpB,CAAD,CAAKF,CAAG,CAACuB,UAAJ,CAAe,oBAAf,CAAqC,wBAArC,CAAL,CACf,CALD,IAKO,CACHrB,CAAE,CAACkB,WAAH,CAAe,yBAAf,EACAlB,CAAE,CAACmB,QAAH,CAAY,wBAAZ,EAEAC,CAAY,CAACpB,CAAD,CAAKF,CAAG,CAACuB,UAAJ,CAAe,mBAAf,CAAoC,wBAApC,CAAL,CACf,CAGDrB,CAAE,CAACsB,KAAH,CAAS,GAAT,EAAeC,OAAf,CAAuB,MAAvB,CAA+B,UAAW,CACtC1B,CAAC,CAAC,IAAD,CAAD,CAAQqB,WAAR,CAAoB,oCAApB,EACArB,CAAC,CAAC,IAAD,CAAD,CAAQqB,WAAR,CAAoB,qCAApB,EAEAE,CAAY,CAACpB,CAAD,CAAKF,CAAG,CAACuB,UAAJ,CAAe,aAAf,CAA8B,wBAA9B,CAAL,CACf,CALD,EAKGG,MALH,CAKU,MALV,CAMH,CA9BE,CAAP,CAgCH,CAjCD,CAkCH,CAOD,QAASJ,CAAAA,CAAT,CAAsBpB,CAAtB,CAA0ByB,CAA1B,CAAsC,CAClC,GAA0B,QAAtB,GAAAzB,CAAE,CAAC0B,GAAH,CAAO,CAAP,EAAUC,OAAd,CAAoC,CAChC3B,CAAE,CAAC4B,IAAH,CAAQH,CAAR,CACH,CAFD,IAEO,CACHzB,CAAE,CAAC6B,IAAH,CAAQ,OAAR,CAAiBJ,CAAjB,CACH,CACJ,CACJ,CAtDE,CAwDV,CAzDK,CAAN","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Javascript controller for the Turnitin Connection Test.\n *\n * @package   plagiarism_turnitinsim\n * @copyright 2018 Turnitin\n * @author    David Winn <dwinn@turnitin.com>\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n/**\n * @module plagiarism_turnitinsim/connection_test\n */\n\ndefine(['jquery', 'core/str'], function($, str) {\n    return {\n        connectionTest: function() {\n            // Store connection test selector.\n            var ct = $('#id_connection_test');\n\n            if (ct.length > 0) {\n                ct.click(function() {\n                    $.ajax({\n                        type: \"POST\",\n                        url: M.cfg.wwwroot + \"/plagiarism/turnitinsim/ajax/connection_test.php\",\n                        dataType: \"json\",\n                        data: {\n                            action: \"connection_test\",\n                            sesskey: M.cfg.sesskey,\n                            apiurl: $('#id_turnitinapiurl').val(),\n                            apikey: $('#id_turnitinapikey').val()\n                        },\n                        success: function(data) {\n                            if (data.connection_status === 200) {\n                                ct.removeClass(\"connection-test-failed\");\n                                ct.addClass(\"connection-test-success\");\n\n                                changeString(ct, str.get_string('connecttestsuccess', 'plagiarism_turnitinsim'));\n                            } else {\n                                ct.removeClass(\"connection-test-success\");\n                                ct.addClass(\"connection-test-failed\");\n\n                                changeString(ct, str.get_string('connecttestfailed', 'plagiarism_turnitinsim'));\n                            }\n\n                            // Fade out classes and swap back values.\n                            ct.delay(1000).fadeOut(\"slow\", function() {\n                                $(this).removeClass(\"turnitinsim_connection-test-failed\");\n                                $(this).removeClass(\"turnitinsim_connection-test-success\");\n\n                                changeString(ct, str.get_string('connecttest', 'plagiarism_turnitinsim'));\n                            }).fadeIn(\"slow\");\n                        }\n                    });\n                });\n            }\n\n            /**\n             * Helper function to change the button text depending on which type of element we're handling.\n             * @param {jQuery} ct - The button element - may be input or button depending on the Moodle theme.\n             * @param {String} langString  - The language string we're setting.\n             */\n            function changeString(ct, langString) {\n                if (ct.get(0).tagName === \"BUTTON\") {\n                    ct.text(langString);\n                } else {\n                    ct.attr('value', langString);\n                }\n            }\n        }\n    };\n});"],"file":"connection_test.min.js"}